RegExp.escape=function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")};(function(a){a.csv={defaults:{separator:",",delimiter:'"',headers:true},hooks:{castToScalar:function(e,d){var b=/\./;if(isNaN(e)){return e}else{if(b.test(e)){return parseFloat(e)}else{var c=parseInt(e);if(isNaN(c)){return null}else{return c}}}}},parsers:{parse:function(g,q){var k=q.separator;var d=q.delimiter;if(!q.state.rowNum){q.state.rowNum=1}if(!q.state.colNum){q.state.colNum=1}var h=[];var n=[];var c=0;var m="";var e=false;function p(){c=0;m="";if(q.start&&q.state.rowNum<q.start){n=[];q.state.rowNum++;q.state.colNum=1;return}if(q.onParseEntry===undefined){h.push(n)}else{var r=q.onParseEntry(n,q.state);if(r!==false){h.push(r)}}n=[];if(q.end&&q.state.rowNum>=q.end){e=true}q.state.rowNum++;q.state.colNum=1}function o(){if(q.onParseValue===undefined){n.push(m)}else{var r=q.onParseValue(m,q.state);if(r!==false){n.push(r)}}m="";c=0;q.state.colNum++}var l=RegExp.escape(k);var f=RegExp.escape(d);var j=/(D|S|\n|\r|[^DS\r\n]+)/;var b=j.source;b=b.replace(/S/g,l);b=b.replace(/D/g,f);j=RegExp(b,"gm");g.replace(j,function(r){if(e){return}switch(c){case 0:if(r===k){m+="";o();break}if(r===d){c=1;break}if(r==="\n"){o();p();break}if(/^\r$/.test(r)){break}m+=r;c=3;break;case 1:if(r===d){c=2;break}m+=r;c=1;break;case 2:if(r===d){m+=r;c=1;break}if(r===k){o();break}if(r==="\n"){o();p();break}if(/^\r$/.test(r)){break}throw new Error("CSVDataError: Illegal State [Row:"+q.state.rowNum+"][Col:"+q.state.colNum+"]");case 3:if(r===k){o();break}if(r==="\n"){o();p();break}if(/^\r$/.test(r)){break}if(r===d){throw new Error("CSVDataError: Illegal Quote [Row:"+q.state.rowNum+"][Col:"+q.state.colNum+"]")}throw new Error("CSVDataError: Illegal Data [Row:"+q.state.rowNum+"][Col:"+q.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+q.state.rowNum+"][Col:"+q.state.colNum+"]")}});if(n.length!==0){o();p()}return h},splitLines:function(g,o){var j=o.separator;var d=o.delimiter;if(!o.state.rowNum){o.state.rowNum=1}var k=[];var c=0;var n="";var e=false;function m(){c=0;if(o.start&&o.state.rowNum<o.start){n="";o.state.rowNum++;return}if(o.onParseEntry===undefined){k.push(n)}else{var p=o.onParseEntry(n,o.state);if(p!==false){k.push(p)}}n="";if(o.end&&o.state.rowNum>=o.end){e=true}o.state.rowNum++}var l=RegExp.escape(j);var f=RegExp.escape(d);var h=/(D|S|\n|\r|[^DS\r\n]+)/;var b=h.source;b=b.replace(/S/g,l);b=b.replace(/D/g,f);h=RegExp(b,"gm");g.replace(h,function(p){if(e){return}switch(c){case 0:if(p===j){n+=p;c=0;break}if(p===d){n+=p;c=1;break}if(p==="\n"){m();break}if(/^\r$/.test(p)){break}n+=p;c=3;break;case 1:if(p===d){n+=p;c=2;break}n+=p;c=1;break;case 2:var q=n.substr(n.length-1);if(p===d&&q===d){n+=p;c=1;break}if(p===j){n+=p;c=0;break}if(p==="\n"){m();break}if(p==="\r"){break}throw new Error("CSVDataError: Illegal state [Row:"+o.state.rowNum+"]");case 3:if(p===j){n+=p;c=0;break}if(p==="\n"){m();break}if(p==="\r"){break}if(p===d){throw new Error("CSVDataError: Illegal quote [Row:"+o.state.rowNum+"]")}throw new Error("CSVDataError: Illegal state [Row:"+o.state.rowNum+"]");default:throw new Error("CSVDataError: Unknown state [Row:"+o.state.rowNum+"]")}});if(n!==""){m()}return k},parseEntry:function(f,n){var h=n.separator;var d=n.delimiter;if(!n.state.rowNum){n.state.rowNum=1}if(!n.state.colNum){n.state.colNum=1}var l=[];var c=0;var k="";function m(){if(n.onParseValue===undefined){l.push(k)}else{var o=n.onParseValue(k,n.state);if(o!==false){l.push(o)}}k="";c=0;n.state.colNum++}if(!n.match){var j=RegExp.escape(h);var e=RegExp.escape(d);var g=/(D|S|\n|\r|[^DS\r\n]+)/;var b=g.source;b=b.replace(/S/g,j);b=b.replace(/D/g,e);n.match=RegExp(b,"gm")}f.replace(n.match,function(o){switch(c){case 0:if(o===h){k+="";m();break}if(o===d){c=1;break}if(o==="\n"||o==="\r"){break}k+=o;c=3;break;case 1:if(o===d){c=2;break}k+=o;c=1;break;case 2:if(o===d){k+=o;c=1;break}if(o===h){m();break}if(o==="\n"||o==="\r"){break}throw new Error("CSVDataError: Illegal State [Row:"+n.state.rowNum+"][Col:"+n.state.colNum+"]");case 3:if(o===h){m();break}if(o==="\n"||o==="\r"){break}if(o===d){throw new Error("CSVDataError: Illegal Quote [Row:"+n.state.rowNum+"][Col:"+n.state.colNum+"]")}throw new Error("CSVDataError: Illegal Data [Row:"+n.state.rowNum+"][Col:"+n.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+n.state.rowNum+"][Col:"+n.state.colNum+"]")}});m();return l}},toArray:function(b,d,g){var d=(d!==undefined?d:{});var c={};c.callback=((g!==undefined&&typeof(g)==="function")?g:false);c.separator="separator" in d?d.separator:a.csv.defaults.separator;c.delimiter="delimiter" in d?d.delimiter:a.csv.defaults.delimiter;var f=(d.state!==undefined?d.state:{});var d={delimiter:c.delimiter,separator:c.separator,onParseEntry:d.onParseEntry,onParseValue:d.onParseValue,state:f};var e=a.csv.parsers.parseEntry(b,d);if(!c.callback){return e}else{c.callback("",e)}},toArrays:function(b,d,f){var d=(d!==undefined?d:{});var c={};c.callback=((f!==undefined&&typeof(f)==="function")?f:false);c.separator="separator" in d?d.separator:a.csv.defaults.separator;c.delimiter="delimiter" in d?d.delimiter:a.csv.defaults.delimiter;var e=[];var d={delimiter:c.delimiter,separator:c.separator,onParseEntry:d.onParseEntry,onParseValue:d.onParseValue,start:d.start,end:d.end,state:{rowNum:1,colNum:1}};e=a.csv.parsers.parse(b,d);if(!c.callback){return e}else{c.callback("",e)}},toObjects:function(g,p,o){var p=(p!==undefined?p:{});var d={};d.callback=((o!==undefined&&typeof(o)==="function")?o:false);d.separator="separator" in p?p.separator:a.csv.defaults.separator;d.delimiter="delimiter" in p?p.delimiter:a.csv.defaults.delimiter;d.headers="headers" in p?p.headers:a.csv.defaults.headers;p.start="start" in p?p.start:1;if(d.headers){p.start++}if(p.end&&d.headers){p.end++}var q=[];var k=[];var p={delimiter:d.delimiter,separator:d.separator,onParseEntry:p.onParseEntry,onParseValue:p.onParseValue,start:p.start,end:p.end,state:{rowNum:1,colNum:1},match:false};var b={delimiter:d.delimiter,separator:d.separator,start:1,end:1,state:{rowNum:1,colNum:1}};var m=a.csv.parsers.splitLines(g,b);var c=a.csv.toArray(m[0],p);var q=a.csv.parsers.splitLines(g,p);p.state.colNum=1;if(c){p.state.rowNum=2}else{p.state.rowNum=1}for(var h=0,l=q.length;h<l;h++){var n=a.csv.toArray(q[h],p);var e={};for(var f in c){e[c[f]]=n[f]}k.push(e);p.state.rowNum++}if(!d.callback){return k}else{d.callback("",k)}},fromArrays:function(e,d,f){var d=(d!==undefined?d:{});var c={};c.callback=((f!==undefined&&typeof(f)==="function")?f:false);c.separator="separator" in d?d.separator:a.csv.defaults.separator;c.delimiter="delimiter" in d?d.delimiter:a.csv.defaults.delimiter;c.escaper="escaper" in d?d.escaper:a.csv.defaults.escaper;c.experimental="experimental" in d?d.experimental:false;if(!c.experimental){throw new Error("not implemented")}var b=[];for(i in e){b.push(e[i])}if(!c.callback){return b}else{c.callback("",b)}},fromObjects2CSV:function(e,d,f){var d=(d!==undefined?d:{});var c={};c.callback=((f!==undefined&&typeof(f)==="function")?f:false);c.separator="separator" in d?d.separator:a.csv.defaults.separator;c.delimiter="delimiter" in d?d.delimiter:a.csv.defaults.delimiter;c.experimental="experimental" in d?d.experimental:false;if(!c.experimental){throw new Error("not implemented")}var b=[];for(i in e){b.push(arrays[i])}if(!c.callback){return b}else{c.callback("",b)}}};a.csvEntry2Array=a.csv.toArray;a.csv2Array=a.csv.toArrays;a.csv2Dictionary=a.csv.toObjects})(jQuery);